# Конфигурация и подготовка к игре

Хотелки по событийной модели данжа.

Источников событий может быть три, как в Марксизме. 

1. Кролик. Что то сделали пользователи. С замком, терминалом, щитком, вентилем, минным датчиком и что нам ещё из устройств придёт в голову и в реализацию.
2. Rest API - что-то нажал оператор в админке.
3. Событие по достижению условий в БД.

Примерное описание события должно быть такое:

Источник. Содержимое. Последствия.

Например. Источник событий щиток. Содержимое (например, json, который он передаёт в кролик при включении батарейки). Последствия. Переход базы в голубой статус, если до этого был синий.

Или. Источник событий вентиль. Содержимое. Успешная (json, который он передаёт при успешной регулировке давления). Последствие. Отмена таймера в событии “Ухудшение радиационной обстановки”.

Или. Источник событий терминал. Содержимое. Игроки выбрали пункт меню “Снижение уровня тревоги”. Последствие. Откат в зелёный статус.

В итоге как это реализовано сейчас:

- есть внутренняя очередь сообщений (internal)
- в нее пишут:
    - MQTT клиенты (через INFO-пакеты)
    - Сервер (через ручки API и сигналы в сохранении моделей БД)
- в ней висит обработчик, который читает входящие сообщения и применяет к ним внутриигровую логику (модуль reactions)